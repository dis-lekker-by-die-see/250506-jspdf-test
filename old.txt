<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Bookstore Inventory Report</title>
    <!-- Use local copies for production stability -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf-autotable@3.8.3/dist/jspdf.plugin.autotable.min.js"></script>
  </head>
  <body>
    <h1>Generate Bookstore Inventory Report</h1>
    <button onclick="generatePDF()">Download PDF</button>

    <script>
      const reportData = {
        reportDate: "2025-05-06",
        totalBooks: 1500,
        categories: ["Fiction", "Non-Fiction", "Sci-Fi", "Mystery"],
        books: [
          {
            title: "The Great Gatsby",
            author: "F. Scott Fitzgerald",
            price: 12.99,
            stock: 45,
          },
          {
            title: "Sapiens",
            author: "Yuval Noah Harari",
            price: 18.5,
            stock: 30,
          },
          { title: "Dune", author: "Frank Herbert", price: 15.75, stock: 60 },
          {
            title: "The Da Vinci Code",
            author: "Dan Brown",
            price: 14.25,
            stock: 25,
          },
          { title: "1984", author: "George Orwell", price: 10.99, stock: 50 },
        ],
      };

      function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Header
        function addHeader() {
          doc.setFont("helvetica", "bold");
          doc.setFontSize(16);
          doc.text("Bookstore Inventory Report", 105, 15, { align: "center" });

          doc.setFont("helvetica", "normal");
          doc.setFontSize(10);
          doc.text(`Date: ${reportData.reportDate}`, 105, 22, {
            align: "center",
          });

          doc.line(10, 25, 200, 25);
        }

        // Footer
        function addFooter() {
          const pageCount = doc.internal.getNumberOfPages();
          const pageHeight = doc.internal.pageSize.height;

          for (let i = 1; i <= pageCount; i++) {
            doc.setPage(i);
            doc.setFontSize(8);
            doc.text(`Page ${i} of ${pageCount}`, 200 - 10, pageHeight - 10, {
              align: "right",
            });
            doc.text("Generated by Bookstore System", 10, pageHeight - 10);
          }
        }

        // Add header to first page
        addHeader();

        // Summary section
        doc.setFont("helvetica", "normal");
        doc.setFontSize(12);
        doc.text("Summary", 10, 35);
        doc.setFontSize(10);
        doc.text(`Total Books: ${reportData.totalBooks}`, 10, 45);
        doc.text(`Categories: ${reportData.categories.join(", ")}`, 10, 50);
        doc.text(
          "This report lists all books in stock as of the report date.",
          10,
          55
        );

        // Books table
        doc.autoTable({
          startY: 65,
          head: [["Title", "Author", "Price ($)", "Stock"]],
          body: reportData.books.map((book) => [
            book.title,
            book.author,
            book.price.toFixed(2),
            book.stock,
          ]),
          theme: "grid",
          headStyles: {
            fillColor: [41, 128, 185],
            textColor: [255, 255, 255],
            fontSize: 10,
            fontStyle: "bold",
          },
          bodyStyles: {
            fontSize: 9,
            textColor: [0, 0, 0],
          },
          alternateRowStyles: {
            fillColor: [240, 240, 240],
          },
          columnStyles: {
            0: { overflow: "linebreak" },
            1: { overflow: "linebreak" },
            2: { halign: "right" },
            3: { halign: "center" },
          },
          margin: { top: 30, left: 10, right: 10 },
          didDrawPage: (hookData) => {
            addHeader();
          },
        });

        // Add footer after all pages are generated
        addFooter();

        // Save PDF
        doc.save("Bookstore_Inventory_Report.pdf");
      }
    </script>
  </body>
</html>
